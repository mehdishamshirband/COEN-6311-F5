import { Directive, Input, Output, EventEmitter } from '@angular/core';
import { from } from 'rxjs';
import * as i0 from "@angular/core";
import * as i1 from "../services/stripe-elements.service";
export class StripeElementsDirective {
    stripeElementsService;
    elementsOptions;
    stripe;
    elements = new EventEmitter();
    _elements;
    state = 'notready';
    constructor(stripeElementsService) {
        this.stripeElementsService = stripeElementsService;
    }
    async ngOnChanges(changes) {
        this.state = 'starting';
        const elementsOptions = this.elementsOptions;
        const stripe = this.stripe;
        if (!stripe) {
            this.state = 'notready';
            return;
        }
        if (changes.elementsOptions) {
            if (this._elements) {
                const payload = Object.keys(elementsOptions).reduce((acc, key) => {
                    if (elementsOptions[key] !== changes.elementsOptions.previousValue[key] &&
                        !['fonts', 'loader', 'clientSecret'].includes(key)) {
                        acc[key] = elementsOptions[key];
                    }
                    return acc;
                }, {});
                this._elements.update(payload);
            }
            else {
                this._elements = await this.stripeElementsService.elements(stripe, elementsOptions).toPromise();
                this.elements.emit(this._elements);
                this.state = 'ready';
            }
        }
    }
    async ngOnInit() {
        if (this.state === 'notready') {
            this.state = 'starting';
            this._elements = await this.stripeElementsService.elements(this.stripe).toPromise();
            this.elements.emit(this._elements);
            this.state = 'ready';
        }
    }
    fetchUpdates() {
        if (!this._elements)
            return null;
        return from(this._elements.fetchUpdates());
    }
    update(options) {
        if (!this._elements)
            return null;
        return this._elements.update(options);
    }
    submit() {
        if (!this._elements)
            return null;
        return from(this._elements.submit());
    }
    getElement(elementType) {
        if (!this._elements)
            return null;
        switch (elementType) {
            case 'address':
                return this._elements.getElement('address');
            case 'paymentMethodMessaging':
                return this._elements.getElement('paymentMethodMessaging');
            case 'affirmMessage':
                return this._elements.getElement('affirmMessage');
            case 'afterpayClearpayMessage':
                return this._elements.getElement('afterpayClearpayMessage');
            case 'auBankAccount':
                return this._elements.getElement('auBankAccount');
            case 'card':
                return this._elements.getElement('card');
            case 'cardNumber':
                return this._elements.getElement('cardNumber');
            case 'cardExpiry':
                return this._elements.getElement('cardExpiry');
            case 'cardCvc':
                return this._elements.getElement('cardCvc');
            case 'cart':
                return this._elements.getElement('cart');
            case 'fpxBank':
                return this._elements.getElement('fpxBank');
            case 'epsBank':
                return this._elements.getElement('epsBank');
            case 'p24Bank':
                return this._elements.getElement('p24Bank');
            case 'iban':
                return this._elements.getElement('iban');
            case 'idealBank':
                return this._elements.getElement('idealBank');
            case 'linkAuthentication':
                return this._elements.getElement('linkAuthentication');
            case 'expressCheckout':
                return this._elements.getElement('expressCheckout');
            case 'payment':
                return this._elements.getElement('payment');
            case 'paymentRequestButton':
                return this._elements.getElement('paymentRequestButton');
            case 'shippingAddress':
                return this._elements.getElement('shippingAddress');
            default:
                return this._elements.getElement(elementType);
        }
    }
    static ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.1.3", ngImport: i0, type: StripeElementsDirective, deps: [{ token: i1.StripeElementsService }], target: i0.ɵɵFactoryTarget.Directive });
    static ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "14.0.0", version: "17.1.3", type: StripeElementsDirective, isStandalone: true, selector: "ngx-stripe-elements,[ngxStripeElements]", inputs: { elementsOptions: "elementsOptions", stripe: "stripe" }, outputs: { elements: "elements" }, usesOnChanges: true, ngImport: i0 });
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.1.3", ngImport: i0, type: StripeElementsDirective, decorators: [{
            type: Directive,
            args: [{
                    selector: 'ngx-stripe-elements,[ngxStripeElements]',
                    standalone: true
                }]
        }], ctorParameters: () => [{ type: i1.StripeElementsService }], propDecorators: { elementsOptions: [{
                type: Input
            }], stripe: [{
                type: Input
            }], elements: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWxlbWVudHMuZGlyZWN0aXZlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvbmd4LXN0cmlwZS9zcmMvbGliL2RpcmVjdGl2ZXMvZWxlbWVudHMuZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFvQyxNQUFNLEVBQUUsWUFBWSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3pHLE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxNQUFNLENBQUM7OztBQW9DNUIsTUFBTSxPQUFPLHVCQUF1QjtJQVNmO0lBUlYsZUFBZSxDQUFpQztJQUNoRCxNQUFNLENBQXlCO0lBRTlCLFFBQVEsR0FBRyxJQUFJLFlBQVksRUFBa0IsQ0FBQztJQUV4RCxTQUFTLENBQWlCO0lBQzFCLEtBQUssR0FBc0MsVUFBVSxDQUFDO0lBRXRELFlBQW1CLHFCQUE0QztRQUE1QywwQkFBcUIsR0FBckIscUJBQXFCLENBQXVCO0lBQUcsQ0FBQztJQUVuRSxLQUFLLENBQUMsV0FBVyxDQUFDLE9BQXNCO1FBQ3RDLElBQUksQ0FBQyxLQUFLLEdBQUcsVUFBVSxDQUFDO1FBRXhCLE1BQU0sZUFBZSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUM7UUFDN0MsTUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQztRQUUzQixJQUFJLENBQUMsTUFBTSxFQUFFO1lBQ1gsSUFBSSxDQUFDLEtBQUssR0FBRyxVQUFVLENBQUM7WUFDeEIsT0FBTztTQUNSO1FBRUQsSUFBSSxPQUFPLENBQUMsZUFBZSxFQUFFO1lBQzNCLElBQUksSUFBSSxDQUFDLFNBQVMsRUFBRTtnQkFDbEIsTUFBTSxPQUFPLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEVBQUU7b0JBQy9ELElBQ0UsZUFBZSxDQUFDLEdBQUcsQ0FBQyxLQUFLLE9BQU8sQ0FBQyxlQUFlLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQzt3QkFDbkUsQ0FBQyxDQUFDLE9BQU8sRUFBRSxRQUFRLEVBQUUsY0FBYyxDQUFDLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxFQUNsRDt3QkFDQSxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDO3FCQUNqQztvQkFDRCxPQUFPLEdBQUcsQ0FBQztnQkFDYixDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7Z0JBRVAsSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUM7YUFDaEM7aUJBQU07Z0JBQ0wsSUFBSSxDQUFDLFNBQVMsR0FBRyxNQUFNLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxRQUFRLENBQUMsTUFBTSxFQUFFLGVBQWUsQ0FBQyxDQUFDLFNBQVMsRUFBRSxDQUFDO2dCQUNoRyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7Z0JBRW5DLElBQUksQ0FBQyxLQUFLLEdBQUcsT0FBTyxDQUFDO2FBQ3RCO1NBQ0Y7SUFDSCxDQUFDO0lBRUQsS0FBSyxDQUFDLFFBQVE7UUFDWixJQUFJLElBQUksQ0FBQyxLQUFLLEtBQUssVUFBVSxFQUFFO1lBQzdCLElBQUksQ0FBQyxLQUFLLEdBQUcsVUFBVSxDQUFDO1lBRXhCLElBQUksQ0FBQyxTQUFTLEdBQUcsTUFBTSxJQUFJLENBQUMscUJBQXFCLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBQztZQUNwRixJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7WUFFbkMsSUFBSSxDQUFDLEtBQUssR0FBRyxPQUFPLENBQUM7U0FDdEI7SUFDSCxDQUFDO0lBRUQsWUFBWTtRQUNWLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUztZQUFFLE9BQU8sSUFBSSxDQUFDO1FBQ2pDLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsWUFBWSxFQUFFLENBQUMsQ0FBQztJQUM3QyxDQUFDO0lBRUQsTUFBTSxDQUFDLE9BQW9DO1FBQ3pDLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUztZQUFFLE9BQU8sSUFBSSxDQUFDO1FBQ2pDLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDeEMsQ0FBQztJQUVELE1BQU07UUFDSixJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVM7WUFBRSxPQUFPLElBQUksQ0FBQztRQUNqQyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUM7SUFDdkMsQ0FBQztJQXNCRCxVQUFVLENBQUMsV0FBVztRQUNwQixJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVM7WUFBRSxPQUFPLElBQUksQ0FBQztRQUVqQyxRQUFRLFdBQVcsRUFBRTtZQUNuQixLQUFLLFNBQVM7Z0JBQ1osT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUM5QyxLQUFLLHdCQUF3QjtnQkFDM0IsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDO1lBQzdELEtBQUssZUFBZTtnQkFDbEIsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxlQUFlLENBQUMsQ0FBQztZQUNwRCxLQUFLLHlCQUF5QjtnQkFDNUIsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDO1lBQzlELEtBQUssZUFBZTtnQkFDbEIsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxlQUFlLENBQUMsQ0FBQztZQUNwRCxLQUFLLE1BQU07Z0JBQ1QsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUMzQyxLQUFLLFlBQVk7Z0JBQ2YsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxZQUFZLENBQUMsQ0FBQztZQUNqRCxLQUFLLFlBQVk7Z0JBQ2YsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxZQUFZLENBQUMsQ0FBQztZQUNqRCxLQUFLLFNBQVM7Z0JBQ1osT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUM5QyxLQUFLLE1BQU07Z0JBQ1QsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUMzQyxLQUFLLFNBQVM7Z0JBQ1osT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUM5QyxLQUFLLFNBQVM7Z0JBQ1osT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUM5QyxLQUFLLFNBQVM7Z0JBQ1osT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUM5QyxLQUFLLE1BQU07Z0JBQ1QsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUMzQyxLQUFLLFdBQVc7Z0JBQ2QsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUNoRCxLQUFLLG9CQUFvQjtnQkFDdkIsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO1lBQ3pELEtBQUssaUJBQWlCO2dCQUNwQixPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLGlCQUFpQixDQUFDLENBQUM7WUFDdEQsS0FBSyxTQUFTO2dCQUNaLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLENBQUM7WUFDOUMsS0FBSyxzQkFBc0I7Z0JBQ3pCLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsc0JBQXNCLENBQUMsQ0FBQztZQUMzRCxLQUFLLGlCQUFpQjtnQkFDcEIsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO1lBQ3REO2dCQUNFLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsV0FBVyxDQUFDLENBQUM7U0FDakQ7SUFDSCxDQUFDO3VHQXpJVSx1QkFBdUI7MkZBQXZCLHVCQUF1Qjs7MkZBQXZCLHVCQUF1QjtrQkFKbkMsU0FBUzttQkFBQztvQkFDVCxRQUFRLEVBQUUseUNBQXlDO29CQUNuRCxVQUFVLEVBQUUsSUFBSTtpQkFDakI7MEZBRVUsZUFBZTtzQkFBdkIsS0FBSztnQkFDRyxNQUFNO3NCQUFkLEtBQUs7Z0JBRUksUUFBUTtzQkFBakIsTUFBTSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERpcmVjdGl2ZSwgSW5wdXQsIE9uSW5pdCwgT25DaGFuZ2VzLCBTaW1wbGVDaGFuZ2VzLCBPdXRwdXQsIEV2ZW50RW1pdHRlciB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgZnJvbSB9IGZyb20gJ3J4anMnO1xuXG5pbXBvcnQge1xuICBTdHJpcGVBZGRyZXNzRWxlbWVudCxcbiAgU3RyaXBlQWZmaXJtTWVzc2FnZUVsZW1lbnQsXG4gIFN0cmlwZUFmdGVycGF5Q2xlYXJwYXlNZXNzYWdlRWxlbWVudCxcbiAgU3RyaXBlQXVCYW5rQWNjb3VudEVsZW1lbnQsXG4gIFN0cmlwZUNhcmRDdmNFbGVtZW50LFxuICBTdHJpcGVDYXJkRWxlbWVudCxcbiAgU3RyaXBlQ2FyZEV4cGlyeUVsZW1lbnQsXG4gIFN0cmlwZUNhcmROdW1iZXJFbGVtZW50LFxuICBTdHJpcGVDYXJ0RWxlbWVudCxcbiAgU3RyaXBlRWxlbWVudHMsXG4gIFN0cmlwZUVsZW1lbnRzT3B0aW9ucyxcbiAgU3RyaXBlRWxlbWVudHNVcGRhdGVPcHRpb25zLFxuICBTdHJpcGVFcHNCYW5rRWxlbWVudCxcbiAgU3RyaXBlRXhwcmVzc0NoZWNrb3V0RWxlbWVudCxcbiAgU3RyaXBlRnB4QmFua0VsZW1lbnQsXG4gIFN0cmlwZUliYW5FbGVtZW50LFxuICBTdHJpcGVJZGVhbEJhbmtFbGVtZW50LFxuICBTdHJpcGVMaW5rQXV0aGVudGljYXRpb25FbGVtZW50LFxuICBTdHJpcGVQMjRCYW5rRWxlbWVudCxcbiAgU3RyaXBlUGF5bWVudEVsZW1lbnQsXG4gIFN0cmlwZVBheW1lbnRNZXRob2RNZXNzYWdpbmdFbGVtZW50LFxuICBTdHJpcGVQYXltZW50UmVxdWVzdEJ1dHRvbkVsZW1lbnQsXG4gIFN0cmlwZVNoaXBwaW5nQWRkcmVzc0VsZW1lbnRcbn0gZnJvbSAnQHN0cmlwZS9zdHJpcGUtanMnO1xuXG5pbXBvcnQgeyBTdHJpcGVTZXJ2aWNlSW50ZXJmYWNlIH0gZnJvbSAnLi4vaW50ZXJmYWNlcy9zdHJpcGUtaW5zdGFuY2UuaW50ZXJmYWNlJztcblxuaW1wb3J0IHsgU3RyaXBlRWxlbWVudHNTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvc3RyaXBlLWVsZW1lbnRzLnNlcnZpY2UnO1xuXG5ARGlyZWN0aXZlKHtcbiAgc2VsZWN0b3I6ICduZ3gtc3RyaXBlLWVsZW1lbnRzLFtuZ3hTdHJpcGVFbGVtZW50c10nLFxuICBzdGFuZGFsb25lOiB0cnVlXG59KVxuZXhwb3J0IGNsYXNzIFN0cmlwZUVsZW1lbnRzRGlyZWN0aXZlIGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMge1xuICBASW5wdXQoKSBlbGVtZW50c09wdGlvbnM6IFBhcnRpYWw8U3RyaXBlRWxlbWVudHNPcHRpb25zPjtcbiAgQElucHV0KCkgc3RyaXBlOiBTdHJpcGVTZXJ2aWNlSW50ZXJmYWNlO1xuXG4gIEBPdXRwdXQoKSBlbGVtZW50cyA9IG5ldyBFdmVudEVtaXR0ZXI8U3RyaXBlRWxlbWVudHM+KCk7XG5cbiAgX2VsZW1lbnRzOiBTdHJpcGVFbGVtZW50cztcbiAgc3RhdGU6ICdub3RyZWFkeScgfCAnc3RhcnRpbmcnIHwgJ3JlYWR5JyA9ICdub3RyZWFkeSc7XG5cbiAgY29uc3RydWN0b3IocHVibGljIHN0cmlwZUVsZW1lbnRzU2VydmljZTogU3RyaXBlRWxlbWVudHNTZXJ2aWNlKSB7fVxuXG4gIGFzeW5jIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcbiAgICB0aGlzLnN0YXRlID0gJ3N0YXJ0aW5nJztcblxuICAgIGNvbnN0IGVsZW1lbnRzT3B0aW9ucyA9IHRoaXMuZWxlbWVudHNPcHRpb25zO1xuICAgIGNvbnN0IHN0cmlwZSA9IHRoaXMuc3RyaXBlO1xuXG4gICAgaWYgKCFzdHJpcGUpIHtcbiAgICAgIHRoaXMuc3RhdGUgPSAnbm90cmVhZHknO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChjaGFuZ2VzLmVsZW1lbnRzT3B0aW9ucykge1xuICAgICAgaWYgKHRoaXMuX2VsZW1lbnRzKSB7XG4gICAgICAgIGNvbnN0IHBheWxvYWQgPSBPYmplY3Qua2V5cyhlbGVtZW50c09wdGlvbnMpLnJlZHVjZSgoYWNjLCBrZXkpID0+IHtcbiAgICAgICAgICBpZiAoXG4gICAgICAgICAgICBlbGVtZW50c09wdGlvbnNba2V5XSAhPT0gY2hhbmdlcy5lbGVtZW50c09wdGlvbnMucHJldmlvdXNWYWx1ZVtrZXldICYmXG4gICAgICAgICAgICAhWydmb250cycsICdsb2FkZXInLCAnY2xpZW50U2VjcmV0J10uaW5jbHVkZXMoa2V5KVxuICAgICAgICAgICkge1xuICAgICAgICAgICAgYWNjW2tleV0gPSBlbGVtZW50c09wdGlvbnNba2V5XTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgfSwge30pO1xuXG4gICAgICAgIHRoaXMuX2VsZW1lbnRzLnVwZGF0ZShwYXlsb2FkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX2VsZW1lbnRzID0gYXdhaXQgdGhpcy5zdHJpcGVFbGVtZW50c1NlcnZpY2UuZWxlbWVudHMoc3RyaXBlLCBlbGVtZW50c09wdGlvbnMpLnRvUHJvbWlzZSgpO1xuICAgICAgICB0aGlzLmVsZW1lbnRzLmVtaXQodGhpcy5fZWxlbWVudHMpO1xuXG4gICAgICAgIHRoaXMuc3RhdGUgPSAncmVhZHknO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIG5nT25Jbml0KCkge1xuICAgIGlmICh0aGlzLnN0YXRlID09PSAnbm90cmVhZHknKSB7XG4gICAgICB0aGlzLnN0YXRlID0gJ3N0YXJ0aW5nJztcblxuICAgICAgdGhpcy5fZWxlbWVudHMgPSBhd2FpdCB0aGlzLnN0cmlwZUVsZW1lbnRzU2VydmljZS5lbGVtZW50cyh0aGlzLnN0cmlwZSkudG9Qcm9taXNlKCk7XG4gICAgICB0aGlzLmVsZW1lbnRzLmVtaXQodGhpcy5fZWxlbWVudHMpO1xuXG4gICAgICB0aGlzLnN0YXRlID0gJ3JlYWR5JztcbiAgICB9XG4gIH1cblxuICBmZXRjaFVwZGF0ZXMoKSB7XG4gICAgaWYgKCF0aGlzLl9lbGVtZW50cykgcmV0dXJuIG51bGw7XG4gICAgcmV0dXJuIGZyb20odGhpcy5fZWxlbWVudHMuZmV0Y2hVcGRhdGVzKCkpO1xuICB9XG5cbiAgdXBkYXRlKG9wdGlvbnM6IFN0cmlwZUVsZW1lbnRzVXBkYXRlT3B0aW9ucykge1xuICAgIGlmICghdGhpcy5fZWxlbWVudHMpIHJldHVybiBudWxsO1xuICAgIHJldHVybiB0aGlzLl9lbGVtZW50cy51cGRhdGUob3B0aW9ucyk7XG4gIH1cblxuICBzdWJtaXQoKSB7XG4gICAgaWYgKCF0aGlzLl9lbGVtZW50cykgcmV0dXJuIG51bGw7XG4gICAgcmV0dXJuIGZyb20odGhpcy5fZWxlbWVudHMuc3VibWl0KCkpO1xuICB9XG5cbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZTogJ2FkZHJlc3MnKTogU3RyaXBlQWRkcmVzc0VsZW1lbnQgfCBudWxsO1xuICBnZXRFbGVtZW50KGVsZW1lbnRUeXBlOiAncGF5bWVudE1ldGhvZE1lc3NhZ2luZycpOiBTdHJpcGVQYXltZW50TWV0aG9kTWVzc2FnaW5nRWxlbWVudCB8IG51bGw7XG4gIGdldEVsZW1lbnQoZWxlbWVudFR5cGU6ICdhZmZpcm1NZXNzYWdlJyk6IFN0cmlwZUFmZmlybU1lc3NhZ2VFbGVtZW50IHwgbnVsbDtcbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZTogJ2FmdGVycGF5Q2xlYXJwYXlNZXNzYWdlJyk6IFN0cmlwZUFmdGVycGF5Q2xlYXJwYXlNZXNzYWdlRWxlbWVudCB8IG51bGw7XG4gIGdldEVsZW1lbnQoZWxlbWVudFR5cGU6ICdhdUJhbmtBY2NvdW50Jyk6IFN0cmlwZUF1QmFua0FjY291bnRFbGVtZW50IHwgbnVsbDtcbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZTogJ2NhcmQnKTogU3RyaXBlQ2FyZEVsZW1lbnQgfCBudWxsO1xuICBnZXRFbGVtZW50KGVsZW1lbnRUeXBlOiAnY2FyZE51bWJlcicpOiBTdHJpcGVDYXJkTnVtYmVyRWxlbWVudCB8IG51bGw7XG4gIGdldEVsZW1lbnQoZWxlbWVudFR5cGU6ICdjYXJkRXhwaXJ5Jyk6IFN0cmlwZUNhcmRFeHBpcnlFbGVtZW50IHwgbnVsbDtcbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZTogJ2NhcmRDdmMnKTogU3RyaXBlQ2FyZEN2Y0VsZW1lbnQgfCBudWxsO1xuICBnZXRFbGVtZW50KGVsZW1lbnRUeXBlOiAnY2FydCcpOiBTdHJpcGVDYXJ0RWxlbWVudCB8IG51bGw7XG4gIGdldEVsZW1lbnQoZWxlbWVudFR5cGU6ICdmcHhCYW5rJyk6IFN0cmlwZUZweEJhbmtFbGVtZW50IHwgbnVsbDtcbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZTogJ2Vwc0JhbmsnKTogU3RyaXBlRXBzQmFua0VsZW1lbnQgfCBudWxsO1xuICBnZXRFbGVtZW50KGVsZW1lbnRUeXBlOiAncDI0QmFuaycpOiBTdHJpcGVQMjRCYW5rRWxlbWVudCB8IG51bGw7XG4gIGdldEVsZW1lbnQoZWxlbWVudFR5cGU6ICdpYmFuJyk6IFN0cmlwZUliYW5FbGVtZW50IHwgbnVsbDtcbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZTogJ2lkZWFsQmFuaycpOiBTdHJpcGVJZGVhbEJhbmtFbGVtZW50IHwgbnVsbDtcbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZTogJ2xpbmtBdXRoZW50aWNhdGlvbicpOiBTdHJpcGVMaW5rQXV0aGVudGljYXRpb25FbGVtZW50IHwgbnVsbDtcbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZTogJ2V4cHJlc3NDaGVja291dCcpOiBTdHJpcGVFeHByZXNzQ2hlY2tvdXRFbGVtZW50IHwgbnVsbDtcbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZTogJ3BheW1lbnQnKTogU3RyaXBlUGF5bWVudEVsZW1lbnQgfCBudWxsO1xuICBnZXRFbGVtZW50KGVsZW1lbnRUeXBlOiAncGF5bWVudFJlcXVlc3RCdXR0b24nKTogU3RyaXBlUGF5bWVudFJlcXVlc3RCdXR0b25FbGVtZW50IHwgbnVsbDtcbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZTogJ3NoaXBwaW5nQWRkcmVzcycpOiBTdHJpcGVTaGlwcGluZ0FkZHJlc3NFbGVtZW50IHwgbnVsbDtcbiAgZ2V0RWxlbWVudChlbGVtZW50VHlwZSkge1xuICAgIGlmICghdGhpcy5fZWxlbWVudHMpIHJldHVybiBudWxsO1xuXG4gICAgc3dpdGNoIChlbGVtZW50VHlwZSkge1xuICAgICAgY2FzZSAnYWRkcmVzcyc6XG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50cy5nZXRFbGVtZW50KCdhZGRyZXNzJyk7XG4gICAgICBjYXNlICdwYXltZW50TWV0aG9kTWVzc2FnaW5nJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnRzLmdldEVsZW1lbnQoJ3BheW1lbnRNZXRob2RNZXNzYWdpbmcnKTtcbiAgICAgIGNhc2UgJ2FmZmlybU1lc3NhZ2UnOlxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudHMuZ2V0RWxlbWVudCgnYWZmaXJtTWVzc2FnZScpO1xuICAgICAgY2FzZSAnYWZ0ZXJwYXlDbGVhcnBheU1lc3NhZ2UnOlxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudHMuZ2V0RWxlbWVudCgnYWZ0ZXJwYXlDbGVhcnBheU1lc3NhZ2UnKTtcbiAgICAgIGNhc2UgJ2F1QmFua0FjY291bnQnOlxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudHMuZ2V0RWxlbWVudCgnYXVCYW5rQWNjb3VudCcpO1xuICAgICAgY2FzZSAnY2FyZCc6XG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50cy5nZXRFbGVtZW50KCdjYXJkJyk7XG4gICAgICBjYXNlICdjYXJkTnVtYmVyJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnRzLmdldEVsZW1lbnQoJ2NhcmROdW1iZXInKTtcbiAgICAgIGNhc2UgJ2NhcmRFeHBpcnknOlxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudHMuZ2V0RWxlbWVudCgnY2FyZEV4cGlyeScpO1xuICAgICAgY2FzZSAnY2FyZEN2Yyc6XG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50cy5nZXRFbGVtZW50KCdjYXJkQ3ZjJyk7XG4gICAgICBjYXNlICdjYXJ0JzpcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnRzLmdldEVsZW1lbnQoJ2NhcnQnKTtcbiAgICAgIGNhc2UgJ2ZweEJhbmsnOlxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudHMuZ2V0RWxlbWVudCgnZnB4QmFuaycpO1xuICAgICAgY2FzZSAnZXBzQmFuayc6XG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50cy5nZXRFbGVtZW50KCdlcHNCYW5rJyk7XG4gICAgICBjYXNlICdwMjRCYW5rJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnRzLmdldEVsZW1lbnQoJ3AyNEJhbmsnKTtcbiAgICAgIGNhc2UgJ2liYW4nOlxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudHMuZ2V0RWxlbWVudCgnaWJhbicpO1xuICAgICAgY2FzZSAnaWRlYWxCYW5rJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnRzLmdldEVsZW1lbnQoJ2lkZWFsQmFuaycpO1xuICAgICAgY2FzZSAnbGlua0F1dGhlbnRpY2F0aW9uJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnRzLmdldEVsZW1lbnQoJ2xpbmtBdXRoZW50aWNhdGlvbicpO1xuICAgICAgY2FzZSAnZXhwcmVzc0NoZWNrb3V0JzpcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnRzLmdldEVsZW1lbnQoJ2V4cHJlc3NDaGVja291dCcpO1xuICAgICAgY2FzZSAncGF5bWVudCc6XG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50cy5nZXRFbGVtZW50KCdwYXltZW50Jyk7XG4gICAgICBjYXNlICdwYXltZW50UmVxdWVzdEJ1dHRvbic6XG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50cy5nZXRFbGVtZW50KCdwYXltZW50UmVxdWVzdEJ1dHRvbicpO1xuICAgICAgY2FzZSAnc2hpcHBpbmdBZGRyZXNzJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnRzLmdldEVsZW1lbnQoJ3NoaXBwaW5nQWRkcmVzcycpO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnRzLmdldEVsZW1lbnQoZWxlbWVudFR5cGUpO1xuICAgIH1cbiAgfVxufVxuIl19